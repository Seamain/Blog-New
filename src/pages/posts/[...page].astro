---
import { createFullListOfPost } from "../../api/Post";
import type Page from "../../interfaces/Page";
import type Post from "../../interfaces/Post";
import BasicStyle from "../../layouts/BasicStyle.astro";
import PostCard from "../../components/PostCard.astro";
import Pagination from "../../components/Pagination.astro";
import Navbar from "../../components/Navbar.astro";
import type { GetStaticPaths } from "astro";

export const getStaticPaths: GetStaticPaths = async ({ paginate }) => {
  const fullList = await createFullListOfPost("zh-Hans");

  return paginate(fullList, {
    pageSize: 5,
  });
};

const { page } = Astro.props as { page: Page<Post> };
const totalPage = page.lastPage;
---

<BasicStyle title="Posts" description="This is my Posts page.">
  <div class="flex flex-col items-center">
    <Navbar />
    <PostCard ml="not-sm:ml-6" post={page.data[0]} />
    <div
      class="grid grid-cols-2 gap-4 not-sm:flex not-sm:flex-col not-md:flex not-md:flex-col"
    >
      {
        page.data
          .slice(1, 5)
          .map((post) => <PostCard ml="max-h-52" post={post} />)
      }
    </div>
    <div class="flex flex-row mt-12">
      <Pagination
        currentPage={page.currentPage}
        {totalPage}
        url="posts"
        buttonGroup=""
        activeButton="activeButton"
      />
    </div>
  </div>
</BasicStyle>

<style is:global>
  .activeButton {
    --tw-bg-opacity: 1;
    background-color: rgb(239 68 68 / var(--tw-bg-opacity));
    color: wheat;
  }
</style>
